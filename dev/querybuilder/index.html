<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Query Builder · Wasabi.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://iskyd.github.io/Wasabi.jl/querybuilder/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Wasabi.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../api/">API</a></li><li class="is-active"><a class="tocitem" href>Query Builder</a></li><li><a class="tocitem" href="../migrations/">Migrations</a></li><li><a class="tocitem" href="../customtype/">Create Custom Type</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Query Builder</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Query Builder</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/iskyd/Wasabi.jl/blob/main/docs/src/querybuilder.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="QueryBuilder"><a class="docs-heading-anchor" href="#QueryBuilder">QueryBuilder</a><a id="QueryBuilder-1"></a><a class="docs-heading-anchor-permalink" href="#QueryBuilder" title="Permalink"></a></h1><p>You can use QueryBuilder to create and execute a query in a simple and fast way.</p><pre><code class="nohighlight hljs">using Wasabi
using SQLite

mutable struct User &lt;: Wasabi.Model
    id::Int
    name::String
end

configuration = SQLiteConnectionConfiguration(&quot;test.db&quot;)
conn = Wasabi.connect(configuration)

query = QueryBuilder.from(User) |&gt; QueryBuilder.select() |&gt; QueryBuilder.limit(1)
users = Wasabi.df2model(User, Wasabi.execute_query(conn, user))</code></pre><p>QueryBuilder supports select, join, where, limit, offset, group by and order by.</p><p>Select can be expressed as vector of symbols or using SelectExpr object. If no arguments are passed to select then all fields of the model are selected. You can also use alias and select function like count, sum, avg and so on.</p><pre><code class="nohighlight hljs">QueryBuilder.from(User) |&gt; QueryBuilder.select() # Select all fields from user model
QueryBuilder.from(User) |&gt; QueryBuilder.select([:id, :name]) # SELECT user_alias.id, user_alias.name FROM user user_alias
QueryBuilder.from(User) |&gt; QueryBuilder.select(User, :id, :total, :count) # SELECT COUNT(user_alias.id) AS total FROM user user_alias</code></pre><p>Join are expressed using source, target, type (inner, outer ...), on, select. Here&#39;s an example to join User with UserProfile using an INNER JOIN and selecting the &quot;bio&quot; column from UserProfile .</p><pre><code class="nohighlight hljs">query = QueryBuilder.from(User) |&gt; QueryBuilder.select() |&gt; QueryBuilder.join(User, UserProfile, :inner, (:id, :user_id), [:bio])

# SELECT user.id, user.name, user_profile.bio FROM &quot;user&quot; user INNER JOIN &quot;user_profile&quot; user_profile ON user.id = user_profile.user_id</code></pre><p>Where conditions are expressed as Julia Expr object where you can nest and/or conditions. The condition needs to be expressed as (Model, fieldname, function, params).</p><pre><code class="nohighlight hljs">query = QueryBuilder.from(User) |&gt; QueryBuilder.select() |&gt; QueryBuilder.where(:(or, (User, name, like, &quot;%mattia%&quot;), (User, id, in, [1, 2, 3]))) |&gt; QueryBuilder.limit(1)
sql, params = QueryBuilder.build(query)

# println(sql.value) SELECT user.id, user.name FROM &quot;user&quot; user WHERE (user.name LIKE $1 OR user.id IN $2) LIMIT 1
# println(params) # 2-element Vector{Any}: &quot;%mattia%&quot; [1, 2, 3]</code></pre><ul><li><a href="#Wasabi.QueryBuilder.Join"><code>Wasabi.QueryBuilder.Join</code></a></li><li><a href="#Wasabi.QueryBuilder.Query"><code>Wasabi.QueryBuilder.Query</code></a></li><li><a href="#Wasabi.QueryBuilder.SelectExpr"><code>Wasabi.QueryBuilder.SelectExpr</code></a></li><li><a href="#Wasabi.QueryBuilder.build-Tuple{Wasabi.QueryBuilder.Query}"><code>Wasabi.QueryBuilder.build</code></a></li><li><a href="#Wasabi.QueryBuilder.from-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.from</code></a></li><li><a href="#Wasabi.QueryBuilder.groupby-Tuple{Vector{Symbol}}"><code>Wasabi.QueryBuilder.groupby</code></a></li><li><a href="#Wasabi.QueryBuilder.join-Union{Tuple{S}, Tuple{T}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}, Vector{Symbol}}} where {T&lt;:Wasabi.Model, S&lt;:Wasabi.Model}"><code>Wasabi.QueryBuilder.join</code></a></li><li><a href="#Wasabi.QueryBuilder.limit-Tuple{Int64}"><code>Wasabi.QueryBuilder.limit</code></a></li><li><a href="#Wasabi.QueryBuilder.offset-Tuple{Int64}"><code>Wasabi.QueryBuilder.offset</code></a></li><li><a href="#Wasabi.QueryBuilder.orderby-Tuple{Vector{Symbol}}"><code>Wasabi.QueryBuilder.orderby</code></a></li><li><a href="#Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Vector{Symbol}}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.select</code></a></li><li><a href="#Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Symbol}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}, Union{Nothing, Symbol}}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.select</code></a></li><li><a href="#Wasabi.QueryBuilder.select"><code>Wasabi.QueryBuilder.select</code></a></li><li><a href="#Wasabi.QueryBuilder.where-Tuple{Expr}"><code>Wasabi.QueryBuilder.where</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.Join" href="#Wasabi.QueryBuilder.Join"><code>Wasabi.QueryBuilder.Join</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Join{T&lt;:Wasabi.Model}
Represents a join for the given model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L38-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.Query" href="#Wasabi.QueryBuilder.Query"><code>Wasabi.QueryBuilder.Query</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Query{T&lt;:Wasabi.Model}
Represents a query for the given model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L60-L63">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.SelectExpr" href="#Wasabi.QueryBuilder.SelectExpr"><code>Wasabi.QueryBuilder.SelectExpr</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SelectExpr{T&lt;:Wasabi.Model}
Represents a select expression for the given model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L49-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.build-Tuple{Wasabi.QueryBuilder.Query}" href="#Wasabi.QueryBuilder.build-Tuple{Wasabi.QueryBuilder.Query}"><code>Wasabi.QueryBuilder.build</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">build(q::Query)::Tuple{RawQuery, Vector{Any}}
Builds the query and returns a tuple of the query string and the parameters.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L211-L214">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.from-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Wasabi.Model" href="#Wasabi.QueryBuilder.from-Union{Tuple{Type{T}}, Tuple{T}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.from</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">from(source::Type{T})::Query where {T &lt;: Model}
Creates a new query for the given model.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L75-L78">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.groupby-Tuple{Vector{Symbol}}" href="#Wasabi.QueryBuilder.groupby-Tuple{Vector{Symbol}}"><code>Wasabi.QueryBuilder.groupby</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">groupby(groupby::Vector{Symbol})
Sets the group by clause for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L152-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.join-Union{Tuple{S}, Tuple{T}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}, Vector{Symbol}}} where {T&lt;:Wasabi.Model, S&lt;:Wasabi.Model}" href="#Wasabi.QueryBuilder.join-Union{Tuple{S}, Tuple{T}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}}, Tuple{Type{T}, Type{S}, Symbol, Tuple{Symbol, Symbol}, Vector{Symbol}}} where {T&lt;:Wasabi.Model, S&lt;:Wasabi.Model}"><code>Wasabi.QueryBuilder.join</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">join(m::Type{T}, type::Symbol, on::Tuple{Symbol, Symbol}, select_fields::Vector{Symbol} = Symbol[]) where {T &lt;: Model}
Joins the given model to the query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L163-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.limit-Tuple{Int64}" href="#Wasabi.QueryBuilder.limit-Tuple{Int64}"><code>Wasabi.QueryBuilder.limit</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">limit(limit::Int)
Sets the limit for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L119-L122">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.offset-Tuple{Int64}" href="#Wasabi.QueryBuilder.offset-Tuple{Int64}"><code>Wasabi.QueryBuilder.offset</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">offset(offset::Int)
Sets the offset for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L130-L133">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.orderby-Tuple{Vector{Symbol}}" href="#Wasabi.QueryBuilder.orderby-Tuple{Vector{Symbol}}"><code>Wasabi.QueryBuilder.orderby</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orderby(orderby::Vector{Symbol})
Sets the order by clause for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L141-L144">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.select" href="#Wasabi.QueryBuilder.select"><code>Wasabi.QueryBuilder.select</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">select(select::Union{Vector{Symbol}, Nothing} = nothing)
Sets the selected columns for the given query. If no columns are specified, all columns are selected.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L83-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Symbol}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}, Union{Nothing, Symbol}}} where T&lt;:Wasabi.Model" href="#Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Symbol}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}}, Tuple{Type{T}, Symbol, Union{Nothing, Symbol}, Union{Nothing, Symbol}}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.select</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">selectselect(source::Type{T}, field::Symbol, alias::Union{Symbol, Nothing} = nothing, fn::Union{Symbol, Nothing} = nothing) where {T&lt;:Wasabi.Model}
Sets the selected columns for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L97-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Vector{Symbol}}} where T&lt;:Wasabi.Model" href="#Wasabi.QueryBuilder.select-Union{Tuple{T}, Tuple{Type{T}, Vector{Symbol}}} where T&lt;:Wasabi.Model"><code>Wasabi.QueryBuilder.select</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">select(source::Type{T}, select::Vector{Symbol})
Sets the selected columns for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L108-L111">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Wasabi.QueryBuilder.where-Tuple{Expr}" href="#Wasabi.QueryBuilder.where-Tuple{Expr}"><code>Wasabi.QueryBuilder.where</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">where(expr::Expr)
Sets the where clause for the given query.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/iskyd/Wasabi.jl/blob/0802ab98f0aea72b612ef05f871d5252320533c4/src/QueryBuilder.jl#L175-L178">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API</a><a class="docs-footer-nextpage" href="../migrations/">Migrations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 8 May 2023 12:50">Monday 8 May 2023</span>. Using Julia version 1.9.0-rc3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
